# Detailed Product Requirements Document (PRD): Autonomous Pool Skimmer Mobile App

## Overview
This document outlines the detailed requirements for building a mobile application for managing an autonomous pool skimmer. The app will be developed using **React Native**, **Expo**, and **Firebase**. It will allow users to control the skimmer, view its cleaning history, receive alerts, and configure preferences.

---

## Features & Pages

### **1. Authentication Flow**

#### **Sign-In Page**
- **Requirements:**
  - Contains the following fields:
    - **Email** input field.
    - **Password** input field.
  - Includes the following buttons:
    - **Sign In**: Logs in the user.
    - **Forgot Password**: Redirects to the Forgot Password page.
    - **Sign Up**: Redirects to the Sign-Up page.
  - Authentication handled using **Firebase Authentication**.

#### **Forgot Password Page**
- **Requirements:**
  - Allows the user to enter their email address.
  - Sends a password reset link via Firebase Authentication.

#### **Sign-Up Page**
- **Requirements:**
  - Contains fields for:
    - **Email** input field.
    - **Password** input field.
  - Includes a checkbox for accepting **Terms of Service** and **Privacy Policy**.
  - Creates a new user account in Firebase Authentication.

---

### **2. Side Menu**
- **Requirements:**
  - Displays the user profile information:
    - Profile picture (optional, stored as a URL).
    - Name.
    - Email address.
  - Navigation links to the following pages:
    - **Home**.
    - **Information**.
    - **Maintenance**.
    - **Settings** (optional for future extensions).

---

### **3. Home Page**
- **Requirements:**
  - Displays the following information:
    - **Battery Percentage** (represented as a progress circle).
    - **Current Run Time** (elapsed time).
  - Includes the following buttons:
    - **Start**: Starts a new cleaning cycle.
    - **Pause**: Pauses the current cleaning cycle.
    - **Stop**: Stops the current cleaning cycle.
  - Fetches real-time data from Firebase Firestore linked to the user's paired skimmer device.

---

### **4. Information Page**
- **Requirements:**
  - Displays a list of past cleaning sessions, fetched from Firebase Firestore.
  - Each list item includes:
    - **Date** of the cleaning session.
    - Clicking a date opens a detailed view showing:
      - **Run Time**.
      - Additional metrics (if available in the future).

---

### **5. Maintenance Page**
- **Requirements:**
  - Displays alerts and notifications fetched from Firebase Firestore.
  - Example alerts include:
    - **Device disconnected**.
    - **Low battery percentage** (e.g., 25%, 10%).
    - **Runtime notifications** (e.g., "Current run is almost complete").
  - Each alert includes:
    - **Alert Name** (e.g., "Disconnected").
    - **Timestamp**.

---

### **6. Firebase Firestore Structure**

#### **Users Collection**
Each user document represents an individual app user.

##### **Fields:**
1. **`userId`** (string): Unique identifier for the user.
2. **`email`** (string): User's email address.
3. **`name`** (string): User's full name.
4. **`profilePicture`** (string): URL for the user's profile picture.
5. **`phoneNumber`** (string): User's phone number (optional).
6. **`createdAt`** (timestamp): Date and time when the account was created.
7. **`lastLogin`** (timestamp): Last login time.
8. **`connectedDevices`** (array): List of devices paired with the user.
    - **`deviceId`** (string): Unique ID of the device.
    - **`deviceName`** (string): Name of the device (e.g., "Backyard Pool").
    - **`addedAt`** (timestamp): Date and time when the device was added.
9. **`cleaningPreference`** (map): User's preferences for cleaning schedules.
    - **`startTime`** (number): Preferred start time (in hours, e.g., `8` for 8:00 AM).
    - **`cleaningDuration`** (number): Duration of cleaning in minutes (e.g., `120`).
    - **`cleaningFrequency`** (string): Frequency of cleaning (e.g., "daily").
10. **`alertsEnabled`** (boolean): Whether alerts/notifications are enabled.
11. **`appTheme`** (string): User's preferred app theme (e.g., "dark", "light").
12. **`notificationsToken`** (string): Firebase Cloud Messaging token for push notifications.

#### **Skimmers Collection**
Each skimmer document represents an individual skimmer device.

##### **Fields:**
1. **`deviceId`** (string): Unique identifier for the skimmer.
2. **`alerts`** (array): List of alerts generated by the skimmer.
    - **`alertId`** (string): Unique ID for the alert.
    - **`alertName`** (string): Name of the alert (e.g., "Disconnected").
    - **`alertAt`** (timestamp): Date and time the alert was triggered.
3. **`status`** (string): Current status of the skimmer (e.g., "Idle", "Running").
4. **`batteryLevel`** (number): Current battery percentage.
5. **`lastCleanedAt`** (timestamp): Timestamp of the last cleaning session.
6. **`ownerId`** (string): The `userId` of the user who owns the skimmer.

---

### **Development Phases**

#### **Phase 1: Project Setup**
1. Install **Node.js**, **React Native CLI**, and **Expo CLI**.
    ```bash
    npm install -g expo-cli
    ```
2. Create a new React Native project using Expo:
    ```bash
    expo init pool-skimmer-app
    cd pool-skimmer-app
    ```
3. Install Firebase SDK:
    ```bash
    npm install firebase
    ```
4. Set up Firebase in the project:
    - Create a Firebase project in the Firebase Console.
    - Enable **Authentication** and **Firestore**.
    - Add Firebase configuration to the project.

#### **Phase 2: Authentication**
1. Build Sign-In, Forgot Password, and Sign-Up pages using Firebase Authentication.
2. Test authentication flows on both Android and iOS.

#### **Phase 3: Navigation**
1. Install React Navigation:
    ```bash
    npm install @react-navigation/native
    npm install react-native-screens react-native-safe-area-context react-native-gesture-handler react-native-reanimated react-navigation-drawer
    ```
2. Implement Drawer Navigation for the side menu.

#### **Phase 4: Core Features**
1. Build Home Page with:
    - Start/Pause/Stop buttons.
    - Battery percentage and elapsed time display.
2. Build Information Page with cleaning history.
3. Build Maintenance Page with alert notifications.

#### **Phase 5: Testing and Deployment**
1. Test the app on physical Android and iOS devices.
2. Debug using React Native Debugger and Firebase logs.
3. Build and deploy the app:
    - **Android**: Generate APK using Expo.
    - **iOS**: Build and submit to the App Store via Xcode.

---

This detailed PRD aligns with the wireframes and Firebase structure provided. Let me know if further refinements are needed!
